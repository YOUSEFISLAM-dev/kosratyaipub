<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Korasty AI โ ูุณุงุนุฏ ุงูุชุนูู ุงูุฐูู</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/components.css">
  
  <!-- jsMind CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsmind@0.8.5/style/jsmind.css">
</head>
<body>
  <div class="scene" role="application" aria-label="Korasty AI Learning Platform">
    
    <!-- Header Bar -->
    <header class="header-bar">
      <div class="logo">
        <span class="logo-icon">๐</span>
        <span class="logo-text">Korasty AI</span>
      </div>
      <div class="header-actions">
        <button class="header-btn" id="settingsBtn" title="ุงูุฅุนุฏุงุฏุงุช">โ๏ธ</button>
        <button class="header-btn" id="helpBtn" title="ุงููุณุงุนุฏุฉ">โ</button>
        <div class="user-avatar" id="userAvatar">ู</div>
      </div>
    </header>

    <div class="workspace">

      <!-- LEFT PANEL: Sources -->
      <aside class="panel left" id="leftPanel">
        <div class="panel-header">
          <h1>ุงููุตุงุฏุฑ</h1>
          <button class="icon-btn" id="addSourceBtn" title="ุฅุถุงูุฉ ูุตุฏุฑ">+</button>
        </div>
        
        <button class="add-btn primary" id="uploadSourcesBtn">
          <span class="btn-icon">๐</span>
          <span>ุฅุถุงูุฉ ูุตุงุฏุฑ</span>
        </button>

        <div class="hint-card">
          <div class="hint-icon">๐ฌ</div>
          <div class="hint-content">
            <strong>ุฌุฑุจ ุงูุจุญุซ ุงูุนููู</strong>
            <p>ููุญุตูู ุนูู ุชูุฑูุฑ ุดุงูู ููุตุงุฏุฑ ุฌุฏูุฏุฉ!</p>
          </div>
        </div>

        <div class="search-box">
          <input type="text" id="searchInput" placeholder="ุงุจุญุซ ูู ุงููุตุงุฏุฑ..." />
          <button class="search-btn" id="searchBtn">๐</button>
        </div>

        <div class="source-list" id="sourceList" aria-live="polite">
          <div class="empty-state">
            <span class="empty-icon">๐</span>
            <p>ูุง ุชูุฌุฏ ูุตุงุฏุฑ ุจุนุฏ</p>
          </div>
        </div>

        <div class="supported-formats">
          <p>ุงูุตูุบ ุงููุฏุนููุฉ:</p>
          <div class="format-tags">
            <span class="format-tag">PDF</span>
            <span class="format-tag">TXT</span>
            <span class="format-tag">MD</span>
            <span class="format-tag">MP3</span>
            <span class="format-tag">ุตูุฑ</span>
          </div>
        </div>
      </aside>

      <!-- CENTER PANEL: Main Content / Chat -->
      <main class="panel center" id="centerPanel">
        
        <!-- Initial Upload State -->
        <div class="center-cta" id="centerCta">
          <div class="cta-icon" id="uploadIcon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17 8 12 3 7 8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
          </div>
          <h2>ุฃุถู ูุตุฏุฑุงู ููุจุฏุก</h2>
          <p class="cta-subtitle">ุงุฑูุน ูููุงุชู ุงูุชุนููููุฉ ูุงุจุฏุฃ ุงูุชุนูู ูุน ุงููุนูู ุงูุฐูู</p>
          <button class="upload-btn" id="mainUploadBtn">
            <span>๐ค</span> ุฑูุน ููู
          </button>
          <div class="drop-hint">ุฃู ุงุณุญุจ ุงููููุงุช ูุฃููุชูุง ููุง</div>
        </div>

        <!-- Chat Interface (hidden initially) -->
        <div class="chat-container" id="chatContainer" style="display: none;">
          <div class="chat-header">
            <div class="teacher-avatar">๐จโ๐ซ</div>
            <div class="teacher-info">
              <span class="teacher-name">ุงููุนูู ุงูุฐูู</span>
              <span class="teacher-status">ุฌุงูุฒ ูููุณุงุนุฏุฉ</span>
            </div>
            <div class="chat-actions">
              <button class="chat-action-btn" id="clearChatBtn" title="ูุณุญ ุงููุญุงุฏุซุฉ">๐๏ธ</button>
              <button class="chat-action-btn" id="exportChatBtn" title="ุชุตุฏูุฑ ุงููุญุงุฏุซุฉ">๐</button>
            </div>
          </div>
          
          <div class="chat-messages" id="chatMessages">
            <div class="message assistant">
              <div class="message-avatar">๐จโ๐ซ</div>
              <div class="message-content">
                <p>ูุฑุญุจุงู! ุฃูุง ุงููุนูู ุงูุฐูู. ูููููู ูุณุงุนุฏุชู ูู ููู ุงูููุงุฏ ุงูุชุนููููุฉ ุงูุชู ุฑูุนุชูุง. ุงุณุฃููู ุฃู ุณุคุงู!</p>
              </div>
            </div>
          </div>
          
          <div class="chat-input-container">
            <div class="chat-suggestions" id="chatSuggestions">
              <button class="suggestion-chip">ุงุดุฑุญ ูู ุงูููุฑุฉ ุงูุฑุฆูุณูุฉ</button>
              <button class="suggestion-chip">ูุฎุต ุงููุญุชูู</button>
              <button class="suggestion-chip">ุฃุนุทูู ุฃูุซูุฉ</button>
            </div>
            <div class="chat-input-wrapper">
              <textarea id="chatInput" placeholder="ุงูุชุจ ุณุคุงูู ููุง..." rows="1"></textarea>
              <button class="send-btn" id="sendBtn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Dropzone Overlay -->
        <div class="dropzone" id="dropzone">
          <div class="dropzone-content">
            <span class="dropzone-icon">๐ฅ</span>
            <p>ุฃููุช ุงููููุงุช ููุง</p>
          </div>
        </div>

        <!-- Panel Footer -->
        <div class="panel-footer">
          <div class="footer-info" id="footerInfo">ุงุฑูุน ูุตุฏุฑุงู ููุจุฏุก</div>
          <div class="source-count" id="sourceCount">0 ูุตุงุฏุฑ</div>
        </div>
      </main>

      <!-- RIGHT PANEL: Studio -->
      <aside class="panel right" id="rightPanel">
        <div class="panel-header">
          <h1>ุงูุงุณุชูุฏูู</h1>
          <span class="badge">ุฌุฏูุฏ</span>
        </div>

        <p class="studio-description">ุฅูุดุงุก ูุฎุฑุฌุงุช ุชุนููููุฉ ุจุงูุนุฑุจูุฉ ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู</p>

        <div class="studio-grid" id="studioGrid">
          <button class="studio-btn" data-tool="audio" disabled>
            <span class="studio-icon">๐ง</span>
            <span class="studio-label">ููุฎุต ุตูุชู</span>
            <span class="studio-status">Audio Overview</span>
          </button>
          <button class="studio-btn" data-tool="video" disabled>
            <span class="studio-icon">๐ฌ</span>
            <span class="studio-label">ููุฎุต ููุฏูู</span>
            <span class="studio-status">Video Overview</span>
          </button>
          <button class="studio-btn" data-tool="mindmap" disabled>
            <span class="studio-icon">๐ง</span>
            <span class="studio-label">ุฎุฑูุทุฉ ุฐูููุฉ</span>
            <span class="studio-status">Mind Map</span>
          </button>
          <button class="studio-btn" data-tool="report" disabled>
            <span class="studio-icon">๐</span>
            <span class="studio-label">ุชูุฑูุฑ</span>
            <span class="studio-status">Report</span>
          </button>
          <button class="studio-btn" data-tool="flashcards" disabled>
            <span class="studio-icon">๐</span>
            <span class="studio-label">ุจุทุงูุงุช ุชุนููููุฉ</span>
            <span class="studio-status">Flashcards</span>
          </button>
          <button class="studio-btn" data-tool="quiz" disabled>
            <span class="studio-icon">โ</span>
            <span class="studio-label">ุงุฎุชุจุงุฑ</span>
            <span class="studio-status">Quiz</span>
          </button>
          <button class="studio-btn" data-tool="infographic" disabled>
            <span class="studio-icon">๐</span>
            <span class="studio-label">ุฅูููุฌุฑุงููู</span>
            <span class="studio-status">Infographic</span>
          </button>
          <button class="studio-btn wide" data-tool="slides" disabled>
            <span class="studio-icon">๐ฝ๏ธ</span>
            <span class="studio-label">ุนุฑุถ ุชูุฏููู</span>
            <span class="studio-status">Slide Deck</span>
          </button>
        </div>

        <div class="studio-outputs" id="studioOutputs">
          <h3>ุงููุฎุฑุฌุงุช ุงููุญููุธุฉ</h3>
          <div class="outputs-list" id="outputsList">
            <div class="empty-state small">
              <span class="empty-icon">๐ฆ</span>
              <p>ูุง ุชูุฌุฏ ูุฎุฑุฌุงุช ุจุนุฏ</p>
            </div>
          </div>
        </div>

        <div class="generation-options" id="generationOptions" style="display: none;">
          <h3>ุฎูุงุฑุงุช ุงูุฅูุดุงุก</h3>
          <div class="option-group">
            <label>ุงูุทูู</label>
            <select id="lengthOption">
              <option value="short">ูุตูุฑ</option>
              <option value="medium" selected>ูุชูุณุท</option>
              <option value="long">ุทููู</option>
            </select>
          </div>
          <div class="option-group">
            <label>ุงููุณุชูู</label>
            <select id="levelOption">
              <option value="beginner">ูุจุชุฏุฆ</option>
              <option value="intermediate" selected>ูุชูุณุท</option>
              <option value="advanced">ูุชูุฏู</option>
            </select>
          </div>
          <div class="option-group">
            <label>ุงูุฃุณููุจ</label>
            <select id="styleOption">
              <option value="formal">ุฑุณูู</option>
              <option value="conversational" selected>ูุญุงุฏุซุฉ</option>
              <option value="academic">ุฃูุงุฏููู</option>
            </select>
          </div>
          <button class="generate-btn" id="generateBtn">ุฅูุดุงุก</button>
        </div>

        <div class="panel-footer">
          <button class="add-note-btn" id="addNoteBtn">+ ุฅุถุงูุฉ ููุงุญุธุฉ</button>
        </div>
      </aside>

    </div>
  </div>

  <!-- Hidden file input -->
  <input type="file" id="fileInput" style="display:none" multiple 
    accept=".pdf,.txt,.md,.mp3,.wav,.ogg,.avif,.bmp,.gif,.ico,.jp2,.png,.webp,.tif,.tiff,.heic,.heif,.jpeg,.jpg,.jpe" />

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p id="loadingText">ุฌุงุฑู ุงููุนุงูุฌุฉ...</p>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Settings Modal -->
  <div class="modal" id="settingsModal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ุงูุฅุนุฏุงุฏุงุช</h2>
        <button class="modal-close" id="closeSettingsBtn">ร</button>
      </div>
      <div class="modal-body">
        <div class="setting-group">
          <label>ููุชุงุญ Google AI Studio API</label>
          <input type="password" id="apiKeyInput" placeholder="ุฃุฏุฎู ููุชุงุญ API ุงูุฎุงุต ุจู" />
          <p class="setting-hint">ุงุญุตู ุนูู ููุชุงุญ API ูู <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a></p>
        </div>
        <div class="setting-group">
          <label>ุฑุงุจุท ุงูุฎุงุฏู ุงูุฎููู (Backend URL)</label>
          <input type="text" id="backendUrlInput" placeholder="https://yourusername.pythonanywhere.com" value="https://youseef.pythonanywhere.com" />
          <p class="setting-hint">ุฃุฏุฎู ุฑุงุจุท ุงูุฎุงุฏู ุนูู PythonAnywhere</p>
        </div>
        <div class="setting-group">
          <label>ุงููุบุฉ ุงูุงูุชุฑุงุถูุฉ ูููุฎุฑุฌุงุช</label>
          <select id="outputLanguage">
            <option value="ar" selected>ุงูุนุฑุจูุฉ</option>
            <option value="en">English</option>
          </select>
        </div>
        <div class="setting-group">
          <label>
            <input type="checkbox" id="citationsEnabled" checked />
            ุชุถููู ุงูุงุณุชุดูุงุฏุงุช ูู ุงูุฅุฌุงุจุงุช
          </label>
        </div>
        <button class="save-btn" id="saveSettingsBtn">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
      </div>
    </div>
  </div>

  <!-- Generation Progress Modal -->
  <div class="modal" id="progressModal" style="display: none;">
    <div class="modal-content small">
      <div class="modal-header">
        <h2 id="progressTitle">ุฌุงุฑู ุงูุฅูุดุงุก...</h2>
      </div>
      <div class="modal-body">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
        <p id="progressStatus">ุฌุงุฑู ุงูุชุญููู...</p>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <!-- jsMind Library -->
  <script type="text/javascript" src="//cdn.jsdelivr.net/npm/jsmind/js/jsmind.js"></script>
  
  <script src="js/config.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/api.js"></script>
  <script src="js/fileHandler.js"></script>
  <script src="js/chat.js"></script>
  <script src="js/studio.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
